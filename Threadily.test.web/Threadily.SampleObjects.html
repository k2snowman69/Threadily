<!DOCTYPE html>
<html>
<head>
    <title>Threadily.SampleObjects</title>
    <meta charset="utf-8" />
    <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-2.2.3.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        var Module = {
            onRuntimeInitialized: function () {
                $("#output").text("All ready completed");
                var threadManager = new Module.ThreadManager();
                // UI Thread
                threadManager.getOrCreateThread(0, new Module.VectorUnsignedInt(), null);
                // App Thread
                var notifiedThreads = new Module.VectorUnsignedInt();
                notifiedThreads.push_back(0);
                threadManager.getOrCreateThread(1, notifiedThreads, null);
                // Service Thread
                notifiedThreads = new Module.VectorUnsignedInt();
                notifiedThreads.push_back(1);
                threadManager.getOrCreateThread(2, notifiedThreads, null);

                var exampleThreadObjectManager = new Module.ExampleThreadObjectManager(threadManager);

                var obj_Service = exampleThreadObjectManager.getOrCreateObject(2, 0);
                var obj_UI = exampleThreadObjectManager.getOrCreateObject(0, 0);

                var handler = obj_UI.name.subscribe(new Module.ISubscribeHandleCallbackWString.implement({
                    onChange(newString) {
                        $("#output").text(newString);
                    }
                }));

                obj_Service.name.set("A name");

                window.setTimeout(function () {
                    obj_Service.name.set("A new name");
                }, 2000);

                window.setTimeout(function () {
                    obj_Service.name.set("Another new name");
                }, 5000);
            }
        };
    </script>
    <script src="threadily.sampleObjects.js" type="text/javascript"></script>
</head>
<body>
    <div id="output">Loading...</div>
</body>
</html>
